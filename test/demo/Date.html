<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>AutoComplete</title>

        <link rel="stylesheet" href="http://test.genshuixue.com/asset/css/static/app.css">

        <style>
            .calendar {
                display: none
            }
        </style>

    </head>
    <body>

        <div class="form-date"></div>

        <script src="./js/jquery.js"></script>
        <script src="./js/esl.js"></script>
        <script src="./js/config.js"></script>
        <script>

            require(

                [
                    'cobble/form/Date'
                ],

                function (FormDate) {


                    new FormDate({
                        mainElement: $('.form-date'),
                        value: '2015-09-26',
                        change: {
                            value: function (value) {
                                console.log(value);
                            }
                        },
                        onbeforeopen: function () {
                            console.log('before open');
                        },
                        onafteropen: function () {
                            console.log('after open');
                        },
                        onbeforeclose: function () {
                            console.log('before close');
                        },
                        onafterclose: function () {
                            console.log('after close');
                        },
                        renderTemplate: function (data, tpl) {

                            $.each(
                                data.list,
                                function (index, item) {

                                    item.text = [
                                        item.year,
                                        item.month,
                                        item.date
                                    ].join('-');

                                }
                            );

                            var html = [
                                '<div class="calendar-header">',
                                    '<i class="icon icon-chevron-left"></i>',
                                    '<strong>', data.year, '年', data.month, '月</strong>',
                                    '<i class="icon icon-chevron-right"></i>',
                                '</div>',
                                '<table>',
                                      '<thead>',
                                          '<tr>',
                                              '<th>一</th>',
                                              '<th>二</th>',
                                              '<th>三</th>',
                                              '<th>四</th>',
                                              '<th>五</th>',
                                              '<th>六</th>',
                                              '<th>日</th>',
                                          '</tr>',
                                      '</thead>',
                                      '<tbody>'
                            ];

                            $.each(
                                data.list,
                                function (index, item) {

                                    if (index % 7 === 0) {
                                        html.push(
                                            index === 0 ? '<tr>' : '</tr>'
                                        );
                                    }

                                    html.push('<td class="' + item.phase);

                                    var enable = item.phase !== 'past';

                                    if (!enable) {
                                        html.push(' date-disabled');
                                    }

                                    html.push('"');

                                    if (enable) {
                                        html.push(' data-value="' + item.text + '"');
                                    }

                                    html.push(' data-year="' + item.year + '"');
                                    html.push(' data-month="' + item.month + '"');
                                    html.push(' data-date="' + item.date + '">');
                                    html.push(item.date);
                                    html.push('</td>');

                                }
                            );

                            html.push('</tbody></table>');

                            return html.join('');
                        }
                    });

                }
            );
        </script>
    </body>
</html>